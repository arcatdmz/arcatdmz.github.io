extends ../_layout

block vars
  - var title = en ? 'Awards and Publications' : '受賞歴と発表文献';
  - var me = 'publications/';
  - var containerClass = 'with-rail';

block main
  .left-rail
    +publications-menu()
  .right-content
    h1.ui.header#awards
      i.trophy.icon
      .content #{en ? 'Awards' : '受賞歴'}
    +awards()
    .ui.divider
    h1.ui.header#publications
      i.book.icon
      .content #{en ? 'Publications' : '発表文献'}
    +publications()

block post-footer
  a.ui.circular.icon.popup-menu.large.grey.hidden.button
    i.sidebar.icon
  .ui.hidden.popup-menu.popup
    +publications-menu()

mixin publications-menu()
  .ui.divided.list
    a.item(href='#awards')
      i.trophy.icon
      .content #{en ? 'Awards' : '受賞歴'}
    a.item(href='#publications')
      i.book.icon
      .content #{en ? 'Publications' : '発表文献'}
    block left-rail-list
      .item
        .ui.list
          a.item(href='#archival-publications')
            i.book.icon
            .content Archival
          a.item(href='#non-archival-publications')
            i.book.icon
            .content Others
    a.item(href=`${basePath}timeline/`)
      i.history.icon
      .content #{en ? 'Timeline' : '活動履歴'}

mixin awards()
  .ui.segments
    .ui.secondary.segment
      .ui.horizontal.list
        .item
          i.circle.icon
          .content #{en ? 'Domestic awards' : '国内'}
        .item
          i.world.icon
          .content #{en ? 'International awards' : '国際'}
    .ui.segment
      .ui.divided.list.timeline
        - for (const entry of awards) {
        .item(class=entry.entryType)
          i.icon(class=entry.getIcon())
          .content
            .header !{entry.getText(lang)}
            .description #{entry.getDateString(lang)}
        - }

mixin publications()
  block publications
    h2.ui.header#archival-publications Archival/semi-archival publications
    .ui.segment
      .ui.divided.list
        - for (const entry of publications) {
        - if (entry.entryTags && entry.entryTags.language === 'japanese') continue; // skip Japanese publications
        - if (entry.entryTags && !entry.entryTags.numpages) continue; // skip non-archival publications
        +render-publication(entry)
        - }
    h2.ui.header#non-archival-publications Non-archival publications
    .ui.segment
      .ui.divided.list
        - for (const entry of publications) {
        - if (entry.entryTags && entry.entryTags.language === 'japanese') continue; // skip Japanese publications
        - if (entry.entryTags && entry.entryTags.numpages) continue; // skip archival publications
        +render-publication(entry)
        - }
