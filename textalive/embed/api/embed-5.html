<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=""><meta name="author" content="加藤 淳"><meta property="fb:admins" content="503220390"><link rev="made" href="mailto:i@junkato.jp"><title>TextAlive Web APIテスト (5) | junkato.jp</title><!-- Styles --><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Droid+Sans"><link href="/css/bootstrap.min.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="prism.css" rel="stylesheet"><!-- Le HTML5 shim, for IE6-8 support of HTML5 elements --><!--      [if lt IE 9]>  <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]--></head><body><div class="navbar navbar-default navbar-fixed-top" data-dropdown="dropdown" role="navigation"><div class="container"><div class="navbar-header"><button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navigation"><span class="sr-only">ナビの表示を切り替える</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/ja/">加藤 淳</a></div><div class="collapse navbar-collapse" id="navigation"><ul class="nav navbar-nav"><li><a href="/ja/#about">自己紹介</a></li><li class="active"><a href="/ja/projects">プロジェクト</a></li><li><a href="/ja/publications/">受賞歴と発表文献</a></li><li><a href="/ja/fun/">お楽しみ</a></li><li><a href="/ja/#contact">連絡先</a></li></ul><ul class="nav navbar-nav navbar-right"><li><a href="/ja/blog/">ブログ<i class="blog glyphicon glyphicon-pencil"></i></a></li><li><a href="/textalive/">English<i class="translation glyphicon glyphicon-text-background"></i></a></li></ul></div></div></div><!-- container --><div class="container"><section><h1>TextAlive Web APIテスト (5)</h1><ul class="nav nav-tabs" style="margin-bottom: 5px"><li><a href="embed-1.html">テスト (1)</a></li><li><a href="embed-2.html">テスト (2)</a></li><li><a href="embed-3.html">テスト (3)</a></li><li><a href="embed-4.html">テスト (4)</a></li><li class="active"><a class="disabled">テスト (5)</a></li><li><a href="embed-6.html">テスト (6)</a></li></ul></section><section><h2>全画面埋め込みテスト</h2><p>全画面埋め込みをテストしています。</p><div id="widget"></div><div id="textalive-errors"></div><hr><pre></pre></section><footer><hr><p>©<a href="mailto:i@junkato.jp">Jun Kato</a>2012-2017 |<a href="/ja/textalive/">日本語<i class="translation icon-ja"></i></a></p></footer><script src="prism.js" data-manual=""></script><script src="https://widget.songle.jp/v1/api.js"></script><script src="http://textalive.jp/javascripts/api/embed-v1.js"></script><script id="code">/*
  HTML:
  <div id="player"></div>
  <div id="textalive-errors"></div>
*/
var mySongleWidget, Player, myPlayer;

// SongleWidgetの設置が完了したときに呼ばれるコールバック関数
function onSongleWidgetReady(apiKey, songleWidget) {
  mySongleWidget = songleWidget;
  initialize();
}

// TextAlive APIの準備が完了したときに呼ばれるコールバック関数
function taAsyncInit(P) {
  Player = P;
  initialize();
}

function initialize() {
  // 必要な準備が終わっていなかったら戻る
  if (!mySongleWidget || !Player) return;

  // プレイヤーのスタイルを整えて貼り付ける
  var myPlayerRoot = document.createElement('div');
  myPlayerRoot.style.top = '50px';
  myPlayerRoot.style.left =
  myPlayerRoot.style.right =
  myPlayerRoot.style.bottom = '0px';
  myPlayerRoot.style.position = 'fixed';
  myPlayerRoot.style.zIndex = '2';
  document.body.insertBefore(myPlayerRoot, document.body.firstChild);

  // プレイヤーを作る
  // （playerRootを指定していないので貼り付けはされない）
  myPlayer = new Player({
    songleWidget: mySongleWidget,
    playerRoot: myPlayerRoot,
    infobarPosition: 'left-bottom',
    proportion: 'fill',
    onReady: readyCallback,
    onError: errorCallback
  });

  // 動画を自動生成
  myPlayer.synthVideo();
}

function readyCallback() {
  myPlayer.setDefaultStyle();

  // 以降、プレイヤーへのマウスイベントを透過する
  // （再生ボタンのクリック以降は下のHTML要素に渡す）
  myPlayerRoot.style.pointerEvents = 'none';
}

function errorCallback(err) {
  message = document.createElement('dl');
  for (var key in err) {
    var dt = document.createElement('dt');
    dt.textContent = key;
    var dd = document.createElement('dd');
    dd.textContent = err[key];
    message.appendChild(dt); message.appendChild(dd);
  }
  document.getElementById('textalive-errors').appendChild(message);
}

$(function(){

  // Songle Widgetを貼り付け
  var songleWidgetElement =
    SongleWidgetAPI.createSongleWidgetElement({
      api: "songle-widget-api-example",
      url: "www.youtube.com/watch?v=Za3SaGnFCFI",
      songAutoPlay: false,
      songAutoLoop: false
    });
  $('#widget').append(songleWidgetElement);

  // ソースコードをハイライトして表示
  var el = $('pre').text($('#code').text()).addClass('language-javascript').get(0);
  Prism.highlightElement(el);
});</script></div></body></html>